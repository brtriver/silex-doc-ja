
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>使用方法 | Japan Symfony Group</title>
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/configurationblock.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/js/jquery.corner.js"></script>
      <script type="text/javascript" src="_static/configurationblock.js"></script>
      <script type="text/javascript">
      $(function(){
          $('.section h1').corner();
          $('.highlight-python pre').corner();
          $('.highlight-yml pre').corner();
          $('.highlight').corner();
      });
      </script>
    <link rel="top" title="Silex v0.0.0 documentation" href="index.html" />
    <link rel="next" title="サービス" href="services.html" />
    <link rel="prev" title="イントロダクション" href="intro.html" /> 
  </head>
  <body>

<div id="all">
  <div id="content">
    <div id="content_wrapper">
      <div id="top_menu">
        <div id="top_menu_wrapper">
        </div>
      </div>
      <div id="header_top">
        <h1 id="logo_top"><a href="http://docs.symfony.gr.jp/">Symfonyユーザー会ドキュメントポータル</a></h1>
        <div id="header_top_left"></div>
      </div>
      <!-- end #header -->
      <div id="navbar">
        <ul>
          <li><a href="index.html">トップページ (索引)</a></li>
          <li><a href="extensions/index.html">エクステンション一覧</a></li>
          <li><a href="http://www.silex-project.org/">Silex 公式サイト(英語)</a></li>
          <li><a href="http://www.symfony.gr.jp/">日本Symfonyユーザー会</a></li>
        </ul>
      </div>
      <!-- end #navbar -->
      <div id="main">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="id1">
<h1>使用方法<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>この章では Silex の使い方について説明します。</p>
<div class="section" id="bootstrap">
<h2>Bootstrap<a class="headerlink" href="#bootstrap" title="Permalink to this headline">¶</a></h2>
<p>Silex をインクルードするために必要なことは <tt class="docutils literal"><span class="pre">silex.phar</span></tt> ファイルを require し、 <tt class="docutils literal"><span class="pre">Silex\Application</span></tt> のインスタンスを作成するだけです。
あなたのコントローラーを定義したあとに、 <tt class="docutils literal"><span class="pre">run</span></tt> メソッドをアプリケーション上で呼んでください。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">require_once</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/silex.phar&#39;</span><span class="p">;</span>

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Silex\Application</span><span class="p">();</span>

<span class="c1">// コントローラーの処理内容を定義する</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">Silex\Application</span></tt> のエイリアスとして <tt class="docutils literal"><span class="pre">Application</span></tt> が利用できます。</p>
<p>もうひとつあなたがやらなければならないことは、サーバーの設定を行うことです。
もしApacheを使っていて <tt class="docutils literal"><span class="pre">.htaccess</span></tt> を利用することができるのならば次のように設定してください。</p>
<div class="highlight-apache"><div class="highlight"><pre><span class="nt">&lt;IfModule</span> <span class="s">mod_rewrite.c</span><span class="nt">&gt;</span>
    <span class="nb">Options</span> -MultiViews

    <span class="nb">RewriteEngine</span> <span class="k">On</span>
    <span class="c">#RewriteBase /path/to/app</span>
    <span class="nb">RewriteCond</span> %{REQUEST_FILENAME} !-f
    <span class="nb">RewriteRule</span> ^(.*)$ index.php [QSA,L]
<span class="nt">&lt;/IfModule&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">もし、 Silex を配置するディレクトリが Webのドキュメントルートでない場合は、 <tt class="docutils literal"><span class="pre">RewriteBase</span></tt> のコメントを外し
Webのドキュメントルートからの相対パスであなたのディレクトリ構造に合わせたパスを指定するようにしてください。</p>
</div>
</div>
<div class="section" id="routing">
<h2>ルーティング (Routing)<a class="headerlink" href="#routing" title="Permalink to this headline">¶</a></h2>
<p>Silex ではルーティングと、そのルーティングに一致したときに実行されるコントローラーを定義します</p>
<p>ルーティングのパターンは次のような構成になっています:</p>
<ul class="simple">
<li><em>パターン (Pattern)</em>: ルーティングパターンでリソースへのパスを定義します。
パターンは可変部分を含むことができ、可変部分において正規表現を使った必須項目を設定することができます。</li>
<li><em>メソッド (Method)</em>: 以下の HTTPメソッド のどれかを指定します: <tt class="docutils literal"><span class="pre">GET</span></tt>, <tt class="docutils literal"><span class="pre">POST</span></tt>, <tt class="docutils literal"><span class="pre">PUT</span></tt>
<tt class="docutils literal"><span class="pre">DELETE</span></tt> です。これはリソースとの相互作用を表しています。
一般的には、 <tt class="docutils literal"><span class="pre">GET</span></tt> と <tt class="docutils literal"><span class="pre">POST</span></tt> だけが利用されますが、他のメソッドも使うことが可能です。</li>
</ul>
<p>コントローラーはクロージャーを次のように使うことで定義できます:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// do something</span>
<span class="p">}</span>
</pre></div>
</div>
<p>クロージャーは定義の外部から状態を取り込むことができる無名関数のことです。
これはグローバル変数とは異なります、なぜなら外部の状態はグローバルなものではないからです。
たとえば、メソッドの中にクロージャーを定義することができ、メソッドのローカル変数を取り込むことができます。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">スコープを取り込まないクロージャーはラムダのようだと言われます。
なぜならPHPの無名関数はすべて <tt class="docutils literal"><span class="pre">Closure</span></tt> クラスのインスタンスであり、区別することができないからです。</p>
</div>
<p>クロージャーの戻り値はページのコンテンツになります。</p>
<p>クラスメソッドを利用してコントローラを定義する方法もあります。
<tt class="docutils literal"><span class="pre">ClassName::methodName</span></tt> でのスタティックな呼び出し構文も利用可能です。</p>
<div class="section" id="get">
<h3>GET ルーティングの例<a class="headerlink" href="#get" title="Permalink to this headline">¶</a></h3>
<p>ここに <tt class="docutils literal"><span class="pre">GET</span></tt> ルーティングを定義した例があります:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$blogPosts</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="mi">1</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;date&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;2011-03-29&#39;</span><span class="p">,</span>
        <span class="s1">&#39;author&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;igorw&#39;</span><span class="p">,</span>
        <span class="s1">&#39;title&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;Using Silex&#39;</span><span class="p">,</span>
        <span class="s1">&#39;body&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">);</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/blog&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$blogPosts</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$output</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$blogPosts</span> <span class="k">as</span> <span class="nv">$post</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$output</span> <span class="o">.=</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">];</span>
        <span class="nv">$output</span> <span class="o">.=</span> <span class="s1">&#39;&lt;br /&gt;&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">/blog</span></tt> へアクセスすると 投稿されたブログのタイトルの一覧が返されます。
ここで使われている <tt class="docutils literal"><span class="pre">use</span></tt> はこの文脈では別のものであることを意味します。
外部スコープから $blogPosts 変数を取り込むということをクロージャーに知らせています。
<tt class="docutils literal"><span class="pre">use</span></tt> を使うことでクロージャー内で渡した変数を使うことができるようになります。</p>
</div>
<div class="section" id="dynamic-routing">
<h3>動的ルーティング (Dynamic routing)<a class="headerlink" href="#dynamic-routing" title="Permalink to this headline">¶</a></h3>
<p>さて、ブログの個々の記事を閲覧するためのもう1つ別のコントローラーを用意してみましょう:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpKernel\Exception\NotFoundHttpException</span><span class="p">;</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/blog/show/{id}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$blogPosts</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$blogPosts</span><span class="p">[</span><span class="nv">$id</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">NotFoundHttpException</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nv">$post</span> <span class="o">=</span> <span class="nv">$blogPosts</span><span class="p">[</span><span class="nv">$id</span><span class="p">];</span>

    <span class="k">return</span>  <span class="s2">&quot;&lt;h1&gt;</span><span class="si">{</span><span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/h1&gt;&quot;</span><span class="o">.</span>
            <span class="s2">&quot;&lt;p&gt;</span><span class="si">{</span><span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</div>
<p>ルーティングはクロージャーに渡される <tt class="docutils literal"><span class="pre">{id}</span></tt> という変数を定義しています。</p>
<p>見てわかるように、 もし記事が存在しない場合は <tt class="docutils literal"><span class="pre">NotFoundHttpException</span></tt> を投げます。
後ほど、どのようにハンドリングしているかを説明します。</p>
</div>
<div class="section" id="post">
<h3>POST ルーティングの例<a class="headerlink" href="#post" title="Permalink to this headline">¶</a></h3>
<p>POSTルーティングはリソースの生成を意味します。
この例となるのがフィードバック形式です。
ここでは <a class="reference external" href="http://swiftmailer.org/">Swift Mailer</a> を使うので <tt class="docutils literal"><span class="pre">Swift</span> <span class="pre">Mailer</span></tt> のコピーが <tt class="docutils literal"><span class="pre">vendor/swiftmailer</span></tt> に置かれているとします。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">require_once</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/vendor/swiftmailer/lib/swift_required.php&#39;</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">post</span><span class="p">(</span><span class="s1">&#39;/feedback&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$app</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$request</span> <span class="o">=</span> <span class="nv">$app</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">];</span>

    <span class="nv">$message</span> <span class="o">=</span> <span class="nx">\Swift_Message</span><span class="o">::</span><span class="na">newInstance</span><span class="p">()</span>
        <span class="o">-&gt;</span><span class="na">setSubject</span><span class="p">(</span><span class="s1">&#39;[YourSite] Feedback&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">setFrom</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;noreply@yoursite.com&#39;</span><span class="p">))</span>
        <span class="o">-&gt;</span><span class="na">setTo</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;feedback@yoursite.com&#39;</span><span class="p">))</span>
        <span class="o">-&gt;</span><span class="na">setBody</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">));</span>

    <span class="nv">$transport</span> <span class="o">=</span> <span class="nx">\Swift_MailTransport</span><span class="o">::</span><span class="na">newInstance</span><span class="p">();</span>
    <span class="nv">$mailer</span> <span class="o">=</span> <span class="nx">\Swift_Mailer</span><span class="o">::</span><span class="na">newInstance</span><span class="p">(</span><span class="nv">$transport</span><span class="p">);</span>
    <span class="nv">$mailer</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>

    <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;Thank you for your feedback!&#39;</span><span class="p">,</span> <span class="mi">201</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>かなり単純な方法です。 Swift Mailer ライブラリをインクルードしメッセージを作成しそれを送信しています。</p>
<p>ここで <tt class="docutils literal"><span class="pre">request</span></tt> サービスは 配列のキーを使って取得しています。
サービスのことについてもっと知りたいのであれば、 <em>Services</em> の章を参照してください。
リクエストは <a class="reference external" href="http://api.symfony.com/2.0/Symfony/Component/HttpFoundation/Request.html">Request</a> のインスタンスであり,
リクエストの <tt class="docutils literal"><span class="pre">get</span></tt> メソッドを使うことで変数を取得することができます。</p>
<p>文字列を返す代わりに <a class="reference external" href="http://api.symfony.com/2.0/Symfony/Component/HttpFoundation/Response.html">Response</a> のインスタンスを返すことができます。
また、HTTPのステータスコードを設定することもでき、今回の場合であれば <tt class="docutils literal"><span class="pre">201</span> <span class="pre">Created</span></tt> が設定されています。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Silexはいつも <tt class="docutils literal"><span class="pre">Response</span></tt> を内部で利用し、 HTTPのステータスコードを <tt class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></tt> で、文字列を レスポンスのインスタンスに変換しています。</p>
</div>
</div>
<div class="section" id="id2">
<h3>他のメソッド<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>ほとんどのHTTPメソッドのためのコントローラーを作ることが可能です。 ただ次の中のメソッドから1つを利用すれば良いだけです:
<tt class="docutils literal"><span class="pre">get</span></tt>, <tt class="docutils literal"><span class="pre">post</span></tt>, <tt class="docutils literal"><span class="pre">put</span></tt>, <tt class="docutils literal"><span class="pre">delete</span></tt>.
また、 <tt class="docutils literal"><span class="pre">match</span></tt> メソッドを利用することもでき、この場合はすべてのメソッドに一致します。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">put</span><span class="p">(</span><span class="s1">&#39;/blog&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">});</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ルーティングがどのような順番で定義されたかはとても重要です。
最初に一致したルーティングが利用されるからです。そのため、汎用的なルーティングは一番下に定義するようにしてください。</p>
</div>
</div>
<div class="section" id="id3">
<h3>ルーティング変数<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>前に説明したように、次のようにルーティングにおいて変数を定義することができます:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/blog/show/{id}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">});</span>
</pre></div>
</div>
<p>2つ以上の変数部分を定義することもできますし、変数部分の名前で一致させた引数をクロージャーに渡すことができます。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/blog/show/{postId}/{commentId}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$postId</span><span class="p">,</span> <span class="nv">$commentId</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">});</span>
</pre></div>
</div>
<p>説明していませんでしたが、次のように引数の順番を入れ替えることだってできます。:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/blog/show/{postId}/{commentId}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$commentId</span><span class="p">,</span> <span class="nv">$postId</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3>ルーティングで取得される変数の変換<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>コントローラーにルーティングで取得した変数を注入する前に、変換処理を行うことができます:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/user/{id}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">})</span><span class="o">-&gt;</span><span class="na">convert</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nv">$id</span><span class="p">;</span> <span class="p">});</span>
</pre></div>
</div>
<p>たとえば、ルーティングで取得した変数をオブジェクトに変換し異なるコントローラー間で再利用性を高めたい場合などに便利です:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$userProvider</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">User</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
<span class="p">};</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/user/{user}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">User</span> <span class="nv">$user</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">})</span><span class="o">-&gt;</span><span class="na">convert</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="nv">$userProvider</span><span class="p">);</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/user/{user}/edit&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">User</span> <span class="nv">$user</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">})</span><span class="o">-&gt;</span><span class="na">convert</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="nv">$userProvider</span><span class="p">);</span>
</pre></div>
</div>
<p>変換処理のコールバックは <tt class="docutils literal"><span class="pre">Request</span></tt> を第2引数として受け取ることができます:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$callback</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$post</span><span class="p">,</span> <span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Post</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">attributes</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">));</span>
<span class="p">};</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/blog/{id}/{slug}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Post</span> <span class="nv">$post</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">})</span><span class="o">-&gt;</span><span class="na">convert</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="nv">$callback</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>必須項目<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>特定のパターンのみ一致させたい場合があるでしょう。そのときは正規表現を <tt class="docutils literal"><span class="pre">Controller</span></tt> オブジェクトの <tt class="docutils literal"><span class="pre">assert</span></tt> メソッドを呼ぶことで必須項目を定義することができます。
そしてこの <tt class="docutils literal"><span class="pre">Controller</span></tt> オブジェクトはルーティングメソッドによって返されます。</p>
<p>次のコードは <tt class="docutils literal"><span class="pre">\id+</span></tt> で数値に一致するようにしているので <tt class="docutils literal"><span class="pre">id</span></tt> 引数が数字であることがわかります:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/blog/show/{id}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">})</span>
<span class="o">-&gt;</span><span class="na">assert</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;\d+&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>チェーン(chain) で呼び出すこともできます:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/blog/show/{postId}/{commentId}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$postId</span><span class="p">,</span> <span class="nv">$commentId</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">})</span>
<span class="o">-&gt;</span><span class="na">assert</span><span class="p">(</span><span class="s1">&#39;postId&#39;</span><span class="p">,</span> <span class="s1">&#39;\d+&#39;</span><span class="p">)</span>
<span class="o">-&gt;</span><span class="na">assert</span><span class="p">(</span><span class="s1">&#39;commentId&#39;</span><span class="p">,</span> <span class="s1">&#39;\d+&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>標準の値<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">Controller</span></tt> オブジェクトの <tt class="docutils literal"><span class="pre">value</span></tt> メソッドを呼ぶことでどんなルーティングでも標準の値を定義することができます。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/{pageName}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$pageName</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">})</span>
<span class="o">-&gt;</span><span class="na">value</span><span class="p">(</span><span class="s1">&#39;pageName&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>この例では <tt class="docutils literal"><span class="pre">/</span></tt> がルーティングに一致し、 そして <tt class="docutils literal"><span class="pre">pageName</span></tt> 変数は <tt class="docutils literal"><span class="pre">index</span></tt> になります。</p>
</div>
<div class="section" id="named-routes">
<h3>名前ルーティング (Named routes)<a class="headerlink" href="#named-routes" title="Permalink to this headline">¶</a></h3>
<p>エクステンションの中には名前ルーティングを使うことができるものがあります (<tt class="docutils literal"><span class="pre">UrlGenerator</span></tt> など)。
標準では Silex はあなたの代わりにルーティング名を生成してくれます。しかし、これらは利用されません。
ルーティングメソッドによって返される <tt class="docutils literal"><span class="pre">Controller</span></tt> オブジェクトの <tt class="docutils literal"><span class="pre">bind</span></tt> メソッドを呼び出すことでルーティングに名前を付けることができます。</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">})</span>
<span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;homepage&#39;</span><span class="p">);</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/blog/show/{id}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">...</span>
<span class="p">})</span>
<span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;blog_post&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">使おうとしているエクステンションが <tt class="docutils literal"><span class="pre">RouteCollection</span></tt> を利用しているときのみ名前ルーティングは意味があります。</p>
</div>
</div>
</div>
<div class="section" id="id7">
<h2>前処理と後処理<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>すべてのリクエストの前後でコードを走らせることが可能です。
beforeフィルターとafterフィルターを通して処理されます。利用方法はメソッドにクロージャーを渡すだけです:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">before</span><span class="p">(</span><span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// set up</span>
<span class="p">});</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">after</span><span class="p">(</span><span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// tear down</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h2>エラーハンドリング<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>コードのどこかで例外が発生するとユーザーにエラーページのようなもので表示したいことがあるでしょう。
これらエラーハンドラーがやることなのです。
ログ処理のような処理を追加してエラーハンドリングを使うこともできます。</p>
<p>エラーハンドラーを登録するために、 <tt class="docutils literal"><span class="pre">Exception</span></tt> を引数に持ち、レスポンスを返してくれる <tt class="docutils literal"><span class="pre">error</span></tt> メソッドにクロージャーを渡します:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">\Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;We are sorry, but something went terribly wrong.&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">instanceof</span></tt> を使うことで特定のエラーだけを確認することもできます。そしてエラーの種類で処理を変えることができます:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpKernel\Exception\HttpException</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpKernel\Exception\NotFoundHttpException</span><span class="p">;</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">error</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">\Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$e</span> <span class="nx">instanceof</span> <span class="nx">NotFoundHttpException</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;The requested page could not be found.&#39;</span><span class="p">,</span> <span class="mi">404</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nv">$code</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$e</span> <span class="nx">instanceof</span> <span class="nx">HttpException</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getStatusCode</span><span class="p">()</span> <span class="o">:</span> <span class="mi">500</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;We are sorry, but something went terribly wrong.&#39;</span><span class="p">,</span> <span class="nv">$code</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>ログ処理を行いたいなら、このためにエラーハンドラーを分けて使うことができます。
レスポンスのエラーハンドラーの前にエラーを登録しなければならないということだけに注意してください。
なぜならレスポンスが返されてしまうと、次のようなハンドラーは無視されてしまうからです。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Silex はエラーのログ処理を行うために <a class="reference external" href="https://github.com/Seldaek/monolog">Monolog</a>
を利用するためのエクステンションを利用することができます。
詳しくは <em>Extensions</em> の章を参照してください。</p>
</div>
</div>
<div class="section" id="id9">
<h2>リダイレクト<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>リダイレクト処理のレスポンスを返すことでどんなページにもリダイレクトすることができます。このリダイレクト処理は
<tt class="docutils literal"><span class="pre">redirect</span></tt> メソッドを呼ぶことで作成することができます:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$app</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$app</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="s1">&#39;/hello&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>この例では <tt class="docutils literal"><span class="pre">/</span></tt> から <tt class="docutils literal"><span class="pre">/hello</span></tt> にリダイレクトしようとします。</p>
</div>
<div class="section" id="id10">
<h2>セキュリティー<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>アプリケーションをアタックなどの攻撃から防御する方法を確認しておきましょう。</p>
<div class="section" id="id11">
<h3>エスケープ処理<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>(ルーティングから取得される GET/POST の変数も含め)ユーザー入力した値はどんなものであれアプリケーションを通して出力するときは、正しくエスケープ処理を行う必要があります。
そうすることでクロスサイトスクリプティング(XSS)を防ぐことができます。</p>
<ul>
<li><p class="first"><strong>HTMLのエスケープ処理</strong>: HTMLのエスケープ処理のために PHP は <tt class="docutils literal"><span class="pre">htmlspecialchars</span></tt> 関数　を用意してくれています。
Silex ではこの関数へのショートカットとして <tt class="docutils literal"><span class="pre">escape</span></tt> メソッドを次のように使うことができます:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/name&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$app</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$app</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="s2">&quot;You provided the name </span><span class="si">{</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">escape</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</div>
<p>もし Twigテンプレートを使うのであれば、Twigが用意してくれているエスケープのための記述を使ったり、自動エスケープ機能を使うべきです。</p>
</li>
<li><p class="first"><strong>JSONのエスケープ処理</strong>: もし JSON フォーマットのデータをアプリケーションをで提供するなら、 PHP の <tt class="docutils literal"><span class="pre">json_encode</span></tt> 関数を使います:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/name.json&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$app</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$name</span> <span class="o">=</span> <span class="nv">$app</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span>
        <span class="nx">json_encode</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">)),</span>
        <span class="mi">200</span><span class="p">,</span>
        <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;application/json&#39;</span><span class="p">)</span>
    <span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="id12">
<h2>アプリケーションの再利用<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p>あなたが作成したアプリケーションをより再利用しやすくするためには、次のように <tt class="docutils literal"><span class="pre">run</span></tt> メソッドを呼ぶ代わりに <tt class="docutils literal"><span class="pre">$app</span></tt> 変数を返すようにします:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// blog.php</span>
<span class="k">require_once</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/silex.phar&#39;</span><span class="p">;</span>

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Silex\Application</span><span class="p">();</span>

<span class="c1">// あなたのブログアプリケーションを定義</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/post/{id}&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$id</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">});</span>

<span class="c1">// アプリケーションのインスタンスを返す</span>
<span class="k">return</span> <span class="nv">$app</span><span class="p">;</span>
</pre></div>
</div>
<p>返されたアプリケーションのインスタンスは次のようにして使うことができます:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$app</span> <span class="o">=</span> <span class="k">require</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/blog.php&#39;</span><span class="p">;</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span>
</pre></div>
</div>
<p>このパターンを利用することで、他のどのアプリケーションの中でもこのアプリケーションを簡単に &#8220;マウント&#8221; することができます。:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$blog</span> <span class="o">=</span> <span class="k">require</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/blog.php&#39;</span><span class="p">;</span>

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Silex\Application</span><span class="p">();</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">mount</span><span class="p">(</span><span class="s1">&#39;/blog&#39;</span><span class="p">,</span> <span class="nv">$blog</span><span class="p">);</span>

<span class="c1">// 中心となるアプリケーションを定義</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span>
</pre></div>
</div>
<p>これで、 すでに定義している他のルーティングに加えて <tt class="docutils literal"><span class="pre">/blog/post/{id}</span></tt> というルーティングでブログの投稿処理を行うことができるようになりました。</p>
<p>もし大量のアプリケーションをマウントするのであれば、毎回のリクエストでこれらすべてのアプリケーションを読み込むことによるオーバーヘッドを避けたいことがあるでしょう。
その場合は、 <tt class="docutils literal"><span class="pre">LazyApplication</span></tt> ラッパーを使うことでオーバーヘッドを避けることができます:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$blog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Silex\LazyApplication</span><span class="p">(</span><span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/blog.php&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h2>コンソール<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>Silex には Silex を最新バージョンにアップデートするための軽量なコンソールが用意されています。</p>
<p>あなたが利用している Silex のバージョンを知るためには、 <tt class="docutils literal"><span class="pre">silex.phar</span></tt> をコマンドラインから引数で <tt class="docutils literal"><span class="pre">version</span></tt> を指定して呼び出します:</p>
<div class="highlight-text"><div class="highlight"><pre>$ php silex.phar version
Silex version 0a243d3 2011-04-17 14:49:31 +0200
</pre></div>
</div>
<p>最新バージョンかどうかを確認するためには、 <tt class="docutils literal"><span class="pre">check</span></tt> コマンドを実行します:</p>
<div class="highlight-text"><div class="highlight"><pre>$ php silex.phar check
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">silex.phar</span></tt> を最新バージョンに更新するためには、 <tt class="docutils literal"><span class="pre">update</span></tt> コマンドを実行します:</p>
<p>これで自動的に新しい <tt class="docutils literal"><span class="pre">silex.phar</span></tt> を <tt class="docutils literal"><span class="pre">silex-project.org</span></tt> からダウンロードして既存のものと置き換えてくれます。</p>
</div>
<div class="section" id="pitfalls">
<h2>Pitfalls<a class="headerlink" href="#pitfalls" title="Permalink to this headline">¶</a></h2>
<p>Silex が思ったように動かないときがあるかもしれません。そういったときのためにここによくある動かない原因についてまとめておきましょう。</p>
<div class="section" id="php">
<h3>PHP の設定<a class="headerlink" href="#php" title="Permalink to this headline">¶</a></h3>
<p>PHPのバージョンによってはPharの設定が制限されている場合があります。
その場合は、次のように設定することで解決するかもしれません:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="na">phar.readonly</span> <span class="o">=</span> <span class="s">Off</span>
<span class="na">phar.require_hash</span> <span class="o">=</span> <span class="s">Off</span>
</pre></div>
</div>
<p>もし Suhosin のPHPを使っている場合は、次の設定も行っておく必要があります:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="na">suhosin.executor.include.whitelist</span> <span class="o">=</span> <span class="s">phar</span>
</pre></div>
</div>
</div>
<div class="section" id="phar-stub">
<h3>Phar-Stub のバグ<a class="headerlink" href="#phar-stub" title="Permalink to this headline">¶</a></h3>
<p>インストールされているPHPのバージョンによっては Phar をインクルードしようとすると <tt class="docutils literal"><span class="pre">PharException</span></tt> が発生する場合があります。
そして <tt class="docutils literal"><span class="pre">Silex\Application</span></tt> が見つからないとも言われることもあります。
この場合は回避策として次のように書くことです:</p>
<blockquote>
<div>require_once &#8216;phar://&#8217;.__DIR__.&#8217;/silex.phar/autoload.php&#8217;;</div></blockquote>
<p>この問題の的確な原因はまだ断定されていません。</p>
</div>
</div>
<div class="section" id="iis">
<h2>IIS での設定<a class="headerlink" href="#iis" title="Permalink to this headline">¶</a></h2>
<p>もし Windows から IIS を利用している場合は、次の簡単な <tt class="docutils literal"><span class="pre">web.config</span></tt> ファイルを使うことができます:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;system.webServer&gt;</span>
        <span class="nt">&lt;defaultDocument&gt;</span>
            <span class="nt">&lt;files&gt;</span>
                <span class="nt">&lt;clear</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;add</span> <span class="na">value=</span><span class="s">&quot;index.php&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/files&gt;</span>
        <span class="nt">&lt;/defaultDocument&gt;</span>
        <span class="nt">&lt;rewrite&gt;</span>
            <span class="nt">&lt;rules&gt;</span>
                <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;Silex Front Controller&quot;</span> <span class="na">stopProcessing=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;match</span> <span class="na">url=</span><span class="s">&quot;^(.*)$&quot;</span> <span class="na">ignoreCase=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;conditions</span> <span class="na">logicalGrouping=</span><span class="s">&quot;MatchAll&quot;</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;add</span> <span class="na">input=</span><span class="s">&quot;{REQUEST_FILENAME}&quot;</span> <span class="na">matchType=</span><span class="s">&quot;IsFile&quot;</span> <span class="na">ignoreCase=</span><span class="s">&quot;false&quot;</span> <span class="na">negate=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/conditions&gt;</span>
                    <span class="nt">&lt;action</span> <span class="na">type=</span><span class="s">&quot;Rewrite&quot;</span> <span class="na">url=</span><span class="s">&quot;index.php&quot;</span> <span class="na">appendQueryString=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;/rule&gt;</span>
            <span class="nt">&lt;/rules&gt;</span>
        <span class="nt">&lt;/rewrite&gt;</span>
    <span class="nt">&lt;/system.webServer&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
</div>
</div>


<div id="page_prev_next">
<a class="prev" href="intro.html">< イントロダクション</a>
<a class="next" href="services.html">サービス ></a>
</div>

<div class="common_content_footer">
<ul>
  <li> → <a href="http://silex-project.org/doc/usage.html">公式英語ドキュメント</a></li>
  <li> → <a href="https://github.com/fabpot/Silex/commits/master/doc/usage.rst">原文コミット履歴</a>
  <li> → <a href="https://github.com/brtriver/silex-doc-ja/commits/master/source/usage.rst">翻訳コミット履歴</a>
</ul>
<br />
翻訳の不備などは、お気軽にコメント欄にてご指摘ください！
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'symfony-japan'; // required: replace example with your forum shortname

    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    // var disqus_identifier = 'unique_dynamic_id_1234';
    // var disqus_url = 'http://example.com/permalink-to-page.html';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>


  <!-- X:S ZenBackWidget --><script type="text/javascript">document.write(unescape("%3Cscript")+" src='http://widget.zenback.jp/?base_uri=http%3A//docs.symfony.gr.jp/symfony2/&nsid=96025530184256261%3A%3A96025556490958667&rand="+Math.ceil((new Date()*1)*Math.random())+"' type='text/javascript'"+unescape("%3E%3C/script%3E"));</script><!-- X:E ZenBackWidget -->


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3>このページのコンテンツ</h3>
  <ul>
<li><a class="reference internal" href="#">使用方法</a><ul>
<li><a class="reference internal" href="#bootstrap">Bootstrap</a></li>
<li><a class="reference internal" href="#routing">ルーティング (Routing)</a><ul>
<li><a class="reference internal" href="#get">GET ルーティングの例</a></li>
<li><a class="reference internal" href="#dynamic-routing">動的ルーティング (Dynamic routing)</a></li>
<li><a class="reference internal" href="#post">POST ルーティングの例</a></li>
<li><a class="reference internal" href="#id2">他のメソッド</a></li>
<li><a class="reference internal" href="#id3">ルーティング変数</a></li>
<li><a class="reference internal" href="#id4">ルーティングで取得される変数の変換</a></li>
<li><a class="reference internal" href="#id5">必須項目</a></li>
<li><a class="reference internal" href="#id6">標準の値</a></li>
<li><a class="reference internal" href="#named-routes">名前ルーティング (Named routes)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">前処理と後処理</a></li>
<li><a class="reference internal" href="#id8">エラーハンドリング</a></li>
<li><a class="reference internal" href="#id9">リダイレクト</a></li>
<li><a class="reference internal" href="#id10">セキュリティー</a><ul>
<li><a class="reference internal" href="#id11">エスケープ処理</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id12">アプリケーションの再利用</a></li>
<li><a class="reference internal" href="#id13">コンソール</a></li>
<li><a class="reference internal" href="#pitfalls">Pitfalls</a><ul>
<li><a class="reference internal" href="#php">PHP の設定</a></li>
<li><a class="reference internal" href="#phar-stub">Phar-Stub のバグ</a></li>
</ul>
</li>
<li><a class="reference internal" href="#iis">IIS での設定</a></li>
</ul>
</li>
</ul>

  <h4>前のドキュメント</h4>
  <p class="topless"><a href="intro.html"
                        title="previous chapter">イントロダクション</a></p>
  <h4>次のドキュメント</h4>
  <p class="topless"><a href="services.html"
                        title="next chapter">サービス</a></p>
  <h3>ソース</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/usage.txt"
           rel="nofollow">ページのソースを表示</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>クイック検索</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

      </div>
      <!-- end #main -->
    </div>
    <!-- end #content_wrapper -->
  </div>
  <!-- end #content -->


  <div id="footer">
    <div id="footer_wrapper">
      <div id="footer_content">
        <div style=" position: relative;">
          <div id="footer_left"></div>
          <div id="footer_right"></div>
        </div>
        <div id="f_navbar">
        <ul>
            <li><a href="index.html">トップページ (索引)</a></li>
            <li><a href="extensions/index.html">エクステンション一覧</a></li>
            <li><a href="http://www.silex-project.org/">Silex 公式サイト(英語)</a></li>
            <li><a href="http://www.symfony.gr.jp/">日本Symfonyユーザー会</a></li>
        </ul>
      </div>
      <!-- end #navbar -->
        <div>
          <p id="copy">
            Copyright &copy; 2011 Symfony Japan. All rights reserved.
            &nbsp;&nbsp;&nbsp;Bandwidth and hardware provided by <a href="http://www.asial.co.jp/">アシアル株式会社</a>
            &nbsp;&nbsp;Powered by <a href="http://sphinx.pocoo.org/">Sphinx</a>
          </p>
        </div>
      </div>
      <!-- end #footer_content -->
        </div>
        <!-- end #footer_wrapper -->
      </div>
      <!-- end #footer -->
    </div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-16659283-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  </body>
</html>